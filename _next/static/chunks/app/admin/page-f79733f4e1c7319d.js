(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{255:(e,t,r)=>{"use strict";function n(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return n}}),r(5155),r(7650),r(5744),r(589)},2146:(e,t,r)=>{"use strict";function n(e){let{reason:t,children:r}=e;return r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}}),r(5262)},2643:(e,t,r)=>{"use strict";r.d(t,{$G:()=>u,ND:()=>c});var n=r(5647),a=r(1890);let l="https://zxinatfqwqoqlpihycog.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp4aW5hdGZxd3FvcWxwaWh5Y29nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5MDExMDYsImV4cCI6MjA2NzQ3NzEwNn0.NxUgP8DKXQMdl48RNz1rMDhQqXIAofC_9cFcwVfZRH8",i=a.env.SUPABASE_SERVICE_ROLE_KEY,o=!!(l&&s),u=o&&!!i,c=o?(0,n.UU)(l,s):null;u&&(0,n.UU)(l,i,{auth:{autoRefreshToken:!1,persistSession:!1}})},3860:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>o,A:()=>u});var n=r(5155),a=r(4134);void 0===globalThis.Buffer&&(globalThis.Buffer=a.hp);var l=r(2115),s=r(2643);let i=(0,l.createContext)(null);function o(e){let{children:t}=e,[r,a]=(0,l.useState)(null),[o,u]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{if(!s.ND){console.error("Supabase client is null"),u(!1);return}let{data:e}=s.ND.auth.onAuthStateChange((e,t)=>{var r;a(null!=(r=null==t?void 0:t.user)?r:null),u(!1)});return s.ND.auth.getUser().then(e=>{var t;let{data:r}=e;a(null!=(t=null==r?void 0:r.user)?t:null),u(!1)}),()=>null==e?void 0:e.subscription.unsubscribe()},[]),(0,n.jsx)(i.Provider,{value:{user:r,loading:o},children:t})}function u(){return(0,l.useContext)(i)}},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{bindSnapshot:function(){return s},createAsyncLocalStorage:function(){return l},createSnapshot:function(){return i}});let r=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class n{disable(){throw r}getStore(){}run(){throw r}exit(){throw r}enterWith(){throw r}static bind(e){return e}}let a="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function l(){return a?new a:new n}function s(e){return a?a.bind(e):n.bind(e)}function i(){return a?a.snapshot():function(e,...t){return e(...t)}}},5028:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var n=r(6645),a=r.n(n)},5744:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return n.workAsyncStorageInstance}});let n=r(7828)},6311:(e,t,r)=>{Promise.resolve().then(r.bind(r,7652))},6645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}});let n=r(8229)._(r(7357));function a(e,t){var r;let a={};"function"==typeof e&&(a.loader=e);let l={...a,...t};return(0,n.default)({...l,modules:null==(r=l.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let n=r(5155),a=r(2115),l=r(2146);function s(e){return{default:e&&"default"in e?e.default:e}}r(255);let i={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},o=function(e){let t={...i,...e},r=(0,a.lazy)(()=>t.loader().then(s)),o=t.loading;function u(e){let s=o?(0,n.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,u=i?a.Suspense:a.Fragment,c=t.ssr?(0,n.jsxs)(n.Fragment,{children:[null,(0,n.jsx)(r,{...e})]}):(0,n.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(r,{...e})});return(0,n.jsx)(u,{...i?{fallback:s}:{},children:c})}return u.displayName="LoadableComponent",u}},7652:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var n=r(5155),a=r(2115),l=r(5028),s=r(3860),i=r(2643);function o(){let[e,t]=(0,a.useState)(!1),[r,l]=(0,a.useState)(""),[s,o]=(0,a.useState)(""),[u,c]=(0,a.useState)(""),[d,f]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1);async function b(e){if(e.preventDefault(),m(!0),f(""),!i.ND){f("Supabase nicht konfiguriert"),m(!1);return}let{error:t}=await i.ND.auth.signInWithPassword({email:s,password:u});t&&f(t.message),m(!1)}async function g(e){if(e.preventDefault(),m(!0),f(""),l(""),!i.ND){f("Supabase nicht konfiguriert"),m(!1);return}let{error:t}=await i.ND.auth.resetPasswordForEmail(s,{redirectTo:"".concat(window.location.origin,"/admin")});t?f(t.message):l("E-Mail zum Zur\xfccksetzen wurde gesendet."),m(!1)}async function p(){if(m(!0),f(""),!i.ND){f("Supabase nicht konfiguriert"),m(!1);return}let{error:e}=await i.ND.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/admin")}});e&&f(e.message),m(!1)}return(0,n.jsxs)("form",{onSubmit:e?g:b,className:"max-w-sm mx-auto p-4",children:[(0,n.jsxs)("button",{type:"button",className:"w-full bg-red-600 text-white p-2 mb-2 flex items-center justify-center gap-2 rounded",onClick:p,disabled:h,children:[(0,n.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 48 48",children:(0,n.jsx)("path",{fill:"#fff",d:"M44.5 20H24v8.5h11.7C34.1 33.1 29.6 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c2.7 0 5.2.9 7.2 2.5l6.4-6.4C34.3 5.1 29.4 3 24 3 12.4 3 3 12.4 3 24s9.4 21 21 21c10.5 0 19.5-7.6 21-18h-21V20h21Z"})}),"Mit Google anmelden"]}),(0,n.jsx)("input",{type:"email",placeholder:"E-Mail",value:s,onChange:e=>o(e.target.value),className:"mb-2 w-full border p-2",required:!0}),!e&&(0,n.jsx)("input",{type:"password",placeholder:"Passwort",value:u,onChange:e=>c(e.target.value),className:"mb-2 w-full border p-2",required:!0}),(0,n.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2",disabled:h,children:h?e?"Sende…":"Login…":e?"Passwort zur\xfccksetzen":"Login"}),(0,n.jsx)("div",{className:"flex justify-between mt-2",children:e?(0,n.jsx)("button",{type:"button",className:"text-gray-600 underline text-sm",onClick:()=>{t(!1),f(""),l("")},children:"Zur\xfcck zum Login"}):(0,n.jsx)("button",{type:"button",className:"text-blue-600 underline text-sm",onClick:()=>{t(!0),f(""),l("")},children:"Passwort vergessen?"})}),d&&(0,n.jsx)("div",{className:"text-red-600 mt-2",children:d}),r&&(0,n.jsx)("div",{className:"text-green-600 mt-2",children:r})]})}function u(){return(0,n.jsx)("button",{onClick:()=>{i.ND&&i.ND.auth.signOut()},className:"bg-gray-200 px-4 py-2 rounded",children:"Logout"})}let c=(0,l.default)(()=>Promise.all([r.e(277),r.e(651),r.e(959)]).then(r.bind(r,5959)),{loadableGenerated:{webpack:()=>[5959]},ssr:!1,loading:()=>(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:"Loading Hajila Bau Admin…"})]})})});function d(){var e,t;let r=(0,s.A)(),l=null!=(e=null==r?void 0:r.user)?e:null,d=null==(t=null==r?void 0:r.loading)||t,[f,h]=(0,a.useState)([]),[m,b]=(0,a.useState)(!0),[g,p]=(0,a.useState)(null),x=(0,a.useCallback)(async()=>{b(!0),p(null);try{if(!i.ND)throw Error("Supabase nicht konfiguriert");let{data:e,error:t}=await i.ND.from("carousel_images_metadata").select("*").order("order",{ascending:!0});if(t)throw t;h(null!=e?e:[])}catch(t){let e=t instanceof Error?t.message:"Fehler beim Laden der Bilder.";console.error(e),p(e)}finally{b(!1)}},[]);(0,a.useEffect)(()=>{l&&x()},[l,x]);let j=async e=>{b(!0);let t=null;for(let n of Array.from(e))try{var r;let e=new FormData;e.append("file",n);let t=await fetch("/api/admin/carousel/upload",{method:"POST",body:e}),a=await t.json();if(!t.ok||a.error)throw Error(null!=(r=a.error)?r:"Upload-Fehler: ".concat(n.name))}catch(r){let e=r instanceof Error?r.message:"Unbekannter Fehler";console.error("Upload-Fehler:",n.name,e),t=e}await x(),b(!1),t&&alert("Einige Uploads fehlgeschlagen: ".concat(t))},y=async e=>{b(!0);try{let t=await fetch("/api/admin/carousel/delete?id=".concat(e),{method:"DELETE"}),r=await t.json();if(!t.ok||r.error)throw Error(r.error);await x()}catch(t){let e=t instanceof Error?t.message:"Unbekannter Fehler";console.error("L\xf6sch-Fehler:",e),alert(e)}finally{b(!1)}},w=async(e,t)=>{b(!0);try{let r=await fetch("/api/admin/carousel/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,...t})}),n=await r.json();if(!r.ok||n.error)throw Error(n.error);await x()}catch(t){let e=t instanceof Error?t.message:"Unbekannter Fehler";console.error("Update-Fehler:",e),alert(e)}finally{b(!1)}};return d?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{children:"Authentifizierung wird geladen…"})}):l?(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800",children:(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,n.jsx)("div",{className:"flex justify-end mb-4",children:(0,n.jsx)(u,{})}),(0,n.jsxs)("div",{className:"mb-12 text-center",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold text-slate-900 dark:text-slate-100 mb-4",children:"Hajila Bau GmbH – Admin Dashboard"}),(0,n.jsx)("p",{className:"text-xl text-slate-600 dark:text-slate-400 max-w-3xl mx-auto",children:"Verwalten Sie Website-Inhalte, Projektbilder und Unternehmens\xaddarstellung"})]}),(0,n.jsx)(c,{images:f,isLoading:m,hasError:!!g,onRetry:x,onImageUpload:j,onImageDelete:y,onImageUpdate:w,maxImages:50,allowedFormats:["image/jpeg","image/png","image/webp","image/jpg"],maxFileSize:5242880}),g&&(0,n.jsxs)("p",{className:"text-red-500 mt-4",children:["Fehler: ",g]})]})}):(0,n.jsx)(o,{})}},7828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return n}});let n=(0,r(4054).createAsyncLocalStorage)()}},e=>{var t=t=>e(e.s=t);e.O(0,[647,441,684,358],()=>t(6311)),_N_E=e.O()}]);